# Armv8-M Exception Model
学习: [Armv8-M Exception Model User Guide](../../002.REF_DOCS/armv8-m_exception_model_user_guide_107706_0100_01_en.pdf) 

## STM32 异常处理流程
[Armv8-M Exception Model User Guide #Exception handling sequences](../../002.REF_DOCS/armv8-m_exception_model_user_guide_107706_0100_01_en.pdf)

Cortex-M processors provide a Nested Vectored Interrupt Controller (NVIC) for interrupt handling.(Cortex-M 处理器提供用于中断处理的嵌套矢量中断控制器 （NVIC）)

- ![Figure 1. Sources of NVIC exceptions and interrupts in a Cortex-M based microcontroller](./999.REF_DOCS/86edce61-a587-4bd9-a06b-dd8c607104bb.png)

The NVIC is responsible for deciding which code stream the processor should be executing at any given time. It is also responsible for managing the current execution priority and the priorities assigned to all exception types. For most exceptions, the NVIC also takes care of whether each individual exception is enabled or not. Some exceptions are always enabled.（**NVIC（嵌套向量中断控制器）负责决定处理器在任何给定时刻应执行哪段代码流，同时负责管理当前执行优先级以及分配给所有异常类型的优先级**。对于大多数异常，NVIC还负责处理每个独立异常的启用或禁用状态，但某些异常始终处于启用状态。）

## 中断向量表
解析 [startup_stm32f10x_md.s](../../000.STM32/000.STM32F103C8T6/000.STM32F103C8T6_1/002.BASE_LIBS/device_libs/startup_stm32f10x_md.s) 来分析中断向量表

得结合[Vector table](https://developer.arm.com/documentation/107706/0100/Exceptions-and-interrupts-overview/Vector-table?lang=en) 来学习了

```asm

    定义中断向量表:
    .section	.isr_vector,"a",%progbits

   	.word	SVC_Handler
    // .word 是一个汇编器指令，它的作用是：在当前位置保留一个内存字（32位，4字节）的空间，并用指定的值或地址来初始化这个空间,简单来说，它就是在内存中定义一个 32 位的数值。这个数值可以是一个具体的数字，也可以是一个符号（比如函数名）代表的地址
    // SVC_Handler 是一个符号，通常代表一个中断服务函数的入口地址
    // .word SVC_Handler 这行代码的含义是： 在当前的内存位置，存放一个 32 位的值，这个值就是 SVC_Handler 这个函数的入口地址
```


---

## 参考资料
- [Armv8-M Exception Model User Guide](https://developer.arm.com/documentation/107706/0100?lang=en)
  + [Armv8-M Exception Model User Guide](../../002.REF_DOCS/armv8-m_exception_model_user_guide_107706_0100_01_en.pdf)
- [Armv8-M Architecture Reference Manual](../../002.REF_DOCS/DDI0553B_y_armv8m_arm.pdf)
- [Armv8-M Security Extension User Guide](https://developer.arm.com/documentation/107655/100?lang=en)
